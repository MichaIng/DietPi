# Available DietPi version
G_REMOTE_VERSION_CORE=7
G_REMOTE_VERSION_SUB=9
G_REMOTE_VERSION_RC=3
# Minimum DietPi version to allow update
G_MIN_VERSION_CORE=6
G_MIN_VERSION_SUB=0
# Alternative Git branch to automatically migrate to when DietPi version is too low
G_OLD_VERSION_BRANCH='master'
# Minimum Debian version to allow update
G_MIN_DEBIAN=4
# Alternative Git branch to automatically migrate to when Debian version is too low
G_OLD_DEBIAN_BRANCH='jessie-support'
# Live patches
G_LIVE_PATCH_DESC=(
	[0]='Fix Docker install'
	[1]='SECURITY: Mitigate Log4Shell vulnerability in Airsonic'
	[2]='SECURITY: Mitigate Log4Shell vulnerability in Blynk Server'
)
G_LIVE_PATCH_COND=(
	[0]="grep -q '== 1 && ! -d /lib/modules' /boot/dietpi/dietpi-software"
	[1]='[[ -f /etc/systemd/system/airsonic.service ]] && ! grep -q "\-Dlog4j2.formatMsgNoLookups=true" /etc/systemd/system/airsonic.service'
	[2]='[[ -f /etc/systemd/system/blynkserver.service ]] && ! grep -q "\-Dlog4j2.formatMsgNoLookups=true" /etc/systemd/system/blynkserver.service'
)
G_LIVE_PATCH=(
	[0]="sed -i 's|== 1 \&\& ! -d /lib/modules|== 1 \]\] \&\& \[\[ ! -d /lib/modules|' /boot/dietpi/dietpi-software"
	[1]='sed -i "s/8080 -jar/8080 -Dlog4j2.formatMsgNoLookups=true -jar/" /etc/systemd/system/airsonic.service; systemctl daemon-reload; systemctl restart airsonic'
	[2]='sed -i "s/java -jar/java -Dlog4j2.formatMsgNoLookups=true -jar/" /etc/systemd/system/blynkserver.service; systemctl daemon-reload; systemctl restart blynkserver'
)
